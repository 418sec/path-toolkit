!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.PathToolkit=t()}(this,function(){"use strict";function V(e,t){e.indexOf(P);var r=e.split(P,2),n=!0;if(r[0]){if(r[0]===e)return r[0]===t;n=n&&t.substr(0,r[0].length)===r[0]}return r[1]&&(n=n&&t.substr(-1*r[1].length)===r[1]),n}function q(e){return t.test(e)}function C(e){var t;return typeof e!=T?e&&!0:"TRUE"===(t=e.toUpperCase())||"YES"===t||"ON"===t}var D=void 0,P="*",A="undefined",T="string",F="parent",$="root",U="placeholder",N="context",W="property",Y="collection",z="each",B="singlequote",G="doublequote",H="call",I="evalProperty",t=/^\d+$/;return function(e){function o(){t=Object.keys(S.prefixes),r=Object.keys(S.separators),n=Object.keys(S.containers),i=n.map(function(e){return S.containers[e].closer}),w="",Object.keys(S.separators).forEach(function(e){S.separators[e].exec===W&&(w=e)}),a=h="",Object.keys(S.containers).forEach(function(e){S.containers[e].exec===B&&(h=e),S.containers[e].exec===G&&(a=e)}),l="[\\\\"+[P].concat(t).concat(r).concat(n).join("\\").replace("\\"+w,"")+"]",E=new RegExp(l),u="[\\\\\\"+[P].concat(t).concat(r).concat(n).concat(i).join("\\")+"]",x=new RegExp(u,"g"),m=new RegExp("\\"+u.replace(/^\[/,"[^")),p=h||a?new RegExp("\\["+h+a+"]","g"):"",O=new RegExp("\\"+P)}function s(){(S=S||{}).useCache=!0,S.simple=!1,S.force=!1,S.defaultReturnVal=D,S.prefixes={"^":{exec:F},"~":{exec:$},"%":{exec:U},"@":{exec:N}},S.separators={".":{exec:W},",":{exec:Y},"<":{exec:z}},S.containers={"[":{closer:"]",exec:W},"'":{closer:"'",exec:B},'"':{closer:'"',exec:G},"(":{closer:")",exec:H},"{":{closer:"}",exec:I}}}function g(e){return t=e.replace(p,""),(r=t.length)<2||t[0]!==t[r-1]||t[0]!==h&&t[0]!==a?e:e.slice(1,-1);var t,r}function f(e,t,r){var n,o,s=r!==D,i=0;for(n=t.split(w),S.useCache&&(R[t]={t:n,simple:!0}),o=n.length;e!==D&&i<o;){if(""===n[i])return;s&&(i===o-1?e[n[i]]=r:S.force&&void 0===e[n[i]]&&(e[n[i]]={})),e=e[n[i++]]}return e}function c(e,t,r){for(var n=r!==D,o=0,s=t.length;null!=e&&o<s;){if(""===t[o])return;n&&(o===s-1?e[t[o]]=r:S.force&&void 0===e[t[o]]&&(e[t[o]]={})),e=e[t[o++]]}return e}var t,r,n,i,w,h,a,l,E,u,x,m,p,O,b=this,R={},S={},j=function(e){var t,r="",n=!0,o=[],s=[],i={},a="",f=!1,c=!1,l="",u=0,p="",h="",x="",d=[],y=0,v=0;if(S.useCache&&R[e]!==D)return R[e];if(t=(r=e.replace(m,"$&".substr(1))).length,typeof e==T&&!E.test(e))return o=r.split(w),S.useCache&&(R[e]={t:o,simple:n}),{t:o,simple:n};for(u=0;u<t;u++){if(v||"\\"!==r[u]||(v=u+1,u++),r[u]===P&&(f=!0),0<y)if(v||r[u]!==p||p===h.closer||y++,v||r[u]!==h.closer||y--,0<y)l+=r[u];else{if(u+1<t&&S.separators[r[u+1]]&&S.separators[r[u+1]].exec===Y){if(l.length&&h.exec===W)s=g(l);else if(h.exec===B||h.exec===G)i.has?(s={w:l,mods:i,doEach:c},n&=!(i={})):(s=l,n&=!0);else{if((s=j(l))===D)return;s.exec=h.exec,s.doEach=c}d.push(s)}else if(d[0]){if(l.length&&h.exec===W)s=g(l);else if(h.exec===B||h.exec===G)i.has?(s={w:l,mods:i,doEach:c},n&=!(i={})):(s=l,n&=!0);else{if((s=j(l))===D)return;s.exec=h.exec,s.doEach=c}d.push(s),o.push({tt:d,doEach:c}),n&=!(d=[])}else if(h.exec===W)s={t:[g(l)]},c?(o.push({w:s.t[0],mods:{},doEach:!0}),n&=!1,c=!1):(o.push(s.t[0]),n&=!0);else if(h.exec===B||h.exec===G)i.has?(a={w:l,mods:i,doEach:c},n&=!(i={})):(o.push(l),n&=!0);else{if((s=""===l?{t:[],simple:!0}:j(l))===D)return;s.exec=h.exec,s.doEach=c,o.push(s),n&=!1}l=""}else if(!v&&r[u]in S.prefixes&&S.prefixes[r[u]].exec)i.has=!0,i[S.prefixes[r[u]].exec]?i[S.prefixes[r[u]].exec]++:i[S.prefixes[r[u]].exec]=1;else if(!v&&S.separators[r[u]]&&S.separators[r[u]].exec){if(x=S.separators[r[u]],!a&&(i.has||f))return;a&&(i.has||f||c)&&(a={w:a,mods:i,doEach:c},n&=!(i={})),x.exec===W||x.exec===z?(d[0]!==D?(a&&d.push(a),o.push({tt:d,doEach:c}),n&=!(d=[])):(a&&o.push(a),n&=!0),c=x.exec===z):x.exec===Y&&a&&d.push(a),a="",f=!1}else!v&&S.containers[r[u]]&&S.containers[r[u]].exec?(h=S.containers[r[u]],a&&(i.has||f||c)&&("string"==typeof a?a={w:a,mods:i,doEach:c}:(a.mods=i,a.doEach=c),i={}),d[0]!==D?a&&d.push(a):(a&&o.push(a),n&=!0),p=r[u],a&&S.containers[p].exec!==H&&(c=!1),a="",f=!1,y++):u<t&&(a+=r[u]);u<t&&u===v&&(v=0)}return v||("string"==typeof a&&a&&(i.has||f||c)?(a={w:a,mods:a.mods||i,doEach:c},n&=!(i={})):a&&i.has&&(a.mods=i),d[0]!==D?(a&&d.push(a),o.push({tt:d,doEach:c}),n&=!1):(a&&o.push(a),n&=!0),0!==y)?void 0:(S.useCache&&(R[e]={t:o,simple:n}),{t:o,simple:n})},k=function(e,t,r,n,o){var s,i,a,f,c,l=r!==D,u=[],p=1,h=0,x=0,d=e,y="",v=0,g=0,w="",E=0,m=e,C=!1,P=0,A="";if(typeof t==T)if(S.useCache&&R[t])u=R[t].t;else{if((u=j(t))===D)return;u=u.t}else u=t.t?t.t:[t];if(0!==(s=u.length)){for(i=s-1,o?p=o.length:o=[e];d!==D&&E<s;){if(C=l&&E===i,typeof(y=u[E])==T){if(l)if(C){if(m[y]=r,m[y]!==r)return}else S.force&&void 0===m[y]&&(m[y]={});f=m[y]}else if(y===D)f=void 0;else if(y.tt)if(f=[],y.doEach){if(!Array.isArray(m))return;for(x=0,g=m.length;x<g;){for(h=0,f.push([]),v=y.tt.length;h<v;){if(y.tt[h].doEach=!1,(a=C?k(m[x],y.tt[h],r,n,o):"string"==typeof y.tt[h]?m[x][y.tt[h]]:k(m[x],y.tt[h],void 0,n,o))===D)return;C?y.tt[h].t&&y.tt[h].exec===I?m[x][a]=r:f[x].push(a):y.tt[h].t&&y.tt[h].exec===I?f[x].push(m[x][a]):f[x].push(a),h++}x++}}else for(h=0,v=y.tt.length;h<v;){if((a=C?k(m,y.tt[h],r,n,o):"string"==typeof y.tt[h]?m[y.tt[h]]:k(m,y.tt[h],void 0,n,o))===D)return;C?y.tt[h].t&&y.tt[h].exec===I?m[a]=r:f.push(a):y.tt[h].t&&y.tt[h].exec===I?f.push(m[a]):f.push(a),h++}else if(y.w){if(w=y.w,y.mods.has){if(y.mods.parent&&(m=o[p-1-y.mods.parent])===D)return;if(y.mods.root&&(o=[m=o[0]],p=1),y.mods.placeholder){if(n[P=w-1]===D)return;w=n[P].toString()}}if(y.doEach){if(!Array.isArray(m))return;for(f=[],h=0,g=m.length;h<g;){if(y.mods.context)if(q(w)){if(n[P=w-1]===D)return;f.push(n[P])}else f=w;else if(m[h][w]!==D)C&&(m[h][w]=r),f.push(m[h][w]);else if("function"==typeof m[h])f.push(w);else{if(!O.test(w))return;for(A in f.push([]),m[h])V(w,A)&&(C&&(m[h][A]=r),f[h].push(m[h][A]))}h++}}else if(y.mods.context)if(q(w)){if(n[P=w-1]===D)return;f=n[P]}else f=w;else if(m[w]!==D)C&&(m[w]=r),f=m[w];else if("function"==typeof m)f=w;else{if(!O.test(w))return;for(A in f=[],m)V(w,A)&&(C&&(m[A]=r),f.push(m[A]))}}else if(y.exec===I)if(y.doEach){if(!Array.isArray(m))return;for(f=[],h=0,g=m.length;h<g;)y.simple?(C&&(m[h][b.get(m[h],{t:y.t,simple:!0})]=r),f.push(m[h][b.get(m[h],{t:y.t,simple:!0})])):(C&&(m[h][k(m[h],y,D,n,o)]=r),f.push(m[h][k(m[h],y,D,n,o)])),h++}else f=y.simple?(C&&(m[b.get(m,{t:y.t,simple:!0})]=r),m[b.get(m,{t:y.t,simple:!0})]):(C&&(m[k(m,y,D,n,o)]=r),m[k(m,y,D,n,o)]);else if(y.exec===H)if(y.doEach){if(!Array.isArray(o[p-2]))return;for(f=[],h=0,g=m.length;h<g;)y.t&&y.t.length?(c=k(m,y,D,n,o))===D?f.push(m[h].apply(o[p-2][h])):Array.isArray(c)?f.push(m[h].apply(o[p-2][h],c)):f.push(m[h].call(o[p-2][h],c)):f.push(m[h].call(o[p-2][h])),h++}else f=y.t&&y.t.length?(c=y.simple?b.get(m,y):k(m,y,D,n,o))===D?m.apply(o[p-2]):Array.isArray(c)?m.apply(o[p-2],c):m.call(o[p-2],c):m.call(o[p-2]);d=m=o[p++]=f,E++}return m}},d=function(e,t,r,n,o){var s,i,a,f,c,l,u,p;if(typeof n==A)n="";else if(typeof o!=A&&o(e,n))throw new Error('Circular object provided. Path at "'+n+'" makes a loop.');if(e===t)return r(n);if(Array.isArray(e)){for(i=e.length,s=0;s<i;s++)if(!d(e[s],t,r,""===n?s:n+w+s,o))return;return!0}if(typeof(p=e)==A||null===p||"function"!=typeof p&&"object"!=typeof p)return!0;for(1<(i=(a=Object.keys(e)).length)&&(a=a.sort()),s=0;s<i;s++)if(e.hasOwnProperty(a[s])&&(f=a[s],x.test(f)&&(c=h,l=f,u=new RegExp(c,"g"),f=c+l.replace(u,"\\"+c)+c),!d(e[a[s]],t,r,""===n?f:n+w+f,o)))return;return!0};b.getTokens=function(e){var t=j(e);if(typeof t!=A)return t},b.isValid=function(e){return typeof j(e)!=A},b.escape=function(e){return e.replace(x,"\\$&")},b.get=function(e,t){var r,n,o=0,s=arguments.length;if(typeof t==T)if(S.useCache&&R[t]&&R[t].simple)r=c(e,R[t].t);else if(E.test(t)){if(n=[],2<s)for(o=2;o<s;o++)n[o-2]=arguments[o];r=k(e,t,void 0,n)}else r=f(e,t);else if(Array.isArray(t.t)&&t.simple)r=c(e,t.t);else{if(n=[],2<s)for(o=2;o<s;o++)n[o-2]=arguments[o];r=k(e,t,void 0,n)}return r===D?S.defaultReturnVal:r},b.getWithDefault=function(e,t,r){var n,o=0,s=arguments.length,i=[e,t];if(typeof t==T)if(S.useCache&&R[t]&&R[t].simple)n=c(e,R[t].t);else if(E.test(t)){if(i=[],3<s)for(o=3;o<s;o++)i[o-3]=arguments[o];n=k(e,t,void 0,i)}else n=f(e,t);else if(Array.isArray(t.t)&&t.simple)n=c(e,t.t);else{if(i=[],3<s)for(o=3;o<s;o++)i[o-3]=arguments[o];n=k(e,t,void 0,i)}return n===D?r:n},b.set=function(e,t,r){var n,o,s=0,i=arguments.length,a=!1;if(typeof t==T?S.useCache&&R[t]&&R[t].simple?(o=c(e,R[t].t,r),a|=!0):E.test(t)||(o=f(e,t,r),a|=!0):Array.isArray(t.t)&&t.simple&&(o=c(e,t.t,r),a|=!0),!a){if(3<i)for(n=[],s=3;s<i;s++)n[s-3]=arguments[s];o=k(e,t,r,n)}return Array.isArray(o)?-1===o.indexOf(void 0):o!==D},b.find=function(e,t,r){var n=[];return d(e,t,function(e){return n.push(e),!(!r||"one"===r)}),r&&"one"!==r?0<n.length?n:void 0:0<n.length?n[0]:void 0},b.findSafe=function(n,e,t){var r=[];return d(n,e,function(e){return r.push(e),!(!t||"one"===t)},D,function(e,t){for(var r=b.getTokens(t);r.t.pop();)if(b.get(n,r)===e)return!0;return!1}),t&&"one"!==t?0<r.length?r:void 0:0<r.length?r[0]:void 0};function y(t,r,e,n){var o="";Object.keys(t).forEach(function(e){t[e].exec===r&&(o=e)}),delete t[o],t[e]={exec:r},n&&(t[e].closer=n)}function v(e){var t={};typeof e==T&&1===e.length||(e="."),t[e]={exec:W},S.prefixes={},S.containers={},S.separators=t}b.setOptions=function(e){if(e.prefixes&&(S.prefixes=e.prefixes,R={}),e.separators&&(S.separators=e.separators,R={}),e.containers&&(S.containers=e.containers,R={}),typeof e.cache!=A&&(S.useCache=!!e.cache),typeof e.simple!=A){var t=S.useCache,r=S.force;S.defaultReturnVal;S.simple=C(e.simple),S.simple?v():(s(),S.useCache=t,S.force=r),R={}}typeof e.force!=A&&(S.force=C(e.force)),Object.keys(e).includes("defaultReturnVal")&&(S.defaultReturnVal=e.defaultReturnVal),o()},b.setCache=function(e){S.useCache=C(e)},b.setCacheOn=function(){S.useCache=!0},b.setCacheOff=function(){S.useCache=!1},b.setForce=function(e){S.force=C(e)},b.setForceOn=function(){S.force=!0},b.setForceOff=function(){S.force=!1},b.setSimple=function(e,t){var r=S.useCache,n=S.force;S.simple=C(e),S.simple?(v(t),o()):(s(),o(),S.useCache=r,S.force=n),R={}},b.setSimpleOn=function(e){S.simple=!0,v(e),o(),R={}},b.setSimpleOff=function(){var e=S.useCache,t=S.force;S.simple=!1,s(),o(),S.useCache=e,S.force=t,R={}},b.setDefaultReturnVal=function(e){S.defaultReturnVal=e},b.setSeparatorProperty=function(e){if(typeof e!=T||1!==e.length)throw new Error("setSeparatorProperty - invalid value");if(e===P||S.separators[e]&&S.separators[e].exec!==W||S.prefixes[e]||S.containers[e])throw new Error("setSeparatorProperty - value already in use");y(S.separators,W,e),o(),R={}},b.setSeparatorCollection=function(e){if(typeof e!=T||1!==e.length)throw new Error("setSeparatorCollection - invalid value");if(e===P||S.separators[e]&&S.separators[e].exec!==Y||S.prefixes[e]||S.containers[e])throw new Error("setSeparatorCollection - value already in use");y(S.separators,Y,e),o(),R={}},b.setPrefixParent=function(e){if(typeof e!=T||1!==e.length)throw new Error("setPrefixParent - invalid value");if(e===P||S.prefixes[e]&&S.prefixes[e].exec!==F||S.separators[e]||S.containers[e])throw new Error("setPrefixParent - value already in use");y(S.prefixes,F,e),o(),R={}},b.setPrefixRoot=function(e){if(typeof e!=T||1!==e.length)throw new Error("setPrefixRoot - invalid value");if(e===P||S.prefixes[e]&&S.prefixes[e].exec!==$||S.separators[e]||S.containers[e])throw new Error("setPrefixRoot - value already in use");y(S.prefixes,$,e),o(),R={}},b.setPrefixPlaceholder=function(e){if(typeof e!=T||1!==e.length)throw new Error("setPrefixPlaceholder - invalid value");if(e===P||S.prefixes[e]&&S.prefixes[e].exec!==U||S.separators[e]||S.containers[e])throw new Error("setPrefixPlaceholder - value already in use");y(S.prefixes,U,e),o(),R={}},b.setPrefixContext=function(e){if(typeof e!=T||1!==e.length)throw new Error("setPrefixContext - invalid value");if(e===P||S.prefixes[e]&&S.prefixes[e].exec!==N||S.separators[e]||S.containers[e])throw new Error("setPrefixContext - value already in use");y(S.prefixes,N,e),o(),R={}},b.setContainerProperty=function(e,t){if(typeof e!=T||1!==e.length||typeof t!=T||1!==t.length)throw new Error("setContainerProperty - invalid value");if(e===P||S.containers[e]&&S.containers[e].exec!==W||S.separators[e]||S.prefixes[e])throw new Error("setContainerProperty - value already in use");y(S.containers,W,e,t),o(),R={}},b.setContainerSinglequote=function(e,t){if(typeof e!=T||1!==e.length||typeof t!=T||1!==t.length)throw new Error("setContainerSinglequote - invalid value");if(e===P||S.containers[e]&&S.containers[e].exec!==B||S.separators[e]||S.prefixes[e])throw new Error("setContainerSinglequote - value already in use");y(S.containers,B,e,t),o(),R={}},b.setContainerDoublequote=function(e,t){if(typeof e!=T||1!==e.length||typeof t!=T||1!==t.length)throw new Error("setContainerDoublequote - invalid value");if(e===P||S.containers[e]&&S.containers[e].exec!==G||S.separators[e]||S.prefixes[e])throw new Error("setContainerDoublequote - value already in use");y(S.containers,G,e,t),o(),R={}},b.setContainerCall=function(e,t){if(typeof e!=T||1!==e.length||typeof t!=T||1!==t.length)throw new Error("setContainerCall - invalid value");if(e===P||S.containers[e]&&S.containers[e].exec!==H||S.separators[e]||S.prefixes[e])throw new Error("setContainerCall - value already in use");y(S.containers,H,e,t),o(),R={}},b.setContainerEvalProperty=function(e,t){if(typeof e!=T||1!==e.length||typeof t!=T||1!==t.length)throw new Error("setContainerProperty - invalid value");if(e===P||S.containers[e]&&S.containers[e].exec!==I||S.separators[e]||S.prefixes[e])throw new Error("setContainerEvalProperty - value already in use");y(S.containers,I,e,t),o(),R={}},b.resetOptions=function(){s(),o(),R={}},s(),o(),e&&b.setOptions(e)}});
//# sourceMappingURL=index.js.map
