!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.PathToolkit=t()}(this,function(){"use strict";var e=function(e){return e}(),t="*",r="undefined",n="string",o="parent",s="root",i="placeholder",a="context",f="property",c="collection",l="each",u="singlequote",p="doublequote",h="call",x="evalProperty",y=function(e,r){var n=(e.indexOf(t),e.split(t,2)),o=!0;if(n[0]){if(n[0]===e)return n[0]===r;o=o&&r.substr(0,n[0].length)===n[0]}return n[1]&&(o=o&&r.substr(-1*n[1].length)===n[1]),o},d=function(e){return typeof e===r||null===e?!1:"function"==typeof e||"object"==typeof e},g=/^\d+$/,v=function(e){return g.test(e)},w=function(e){var t;return typeof e!==n?e&&!0:(t=e.toUpperCase(),"TRUE"===t||"YES"===t||"ON"===t)},E=function(e,t){var r=new RegExp(e,"g");return e+t.replace(r,"\\"+e)+e},m=function(g){var m,C,P,O,A,b,S,j,k,R,q,T,D,F,$=this,N={},U={},J=function(){m=Object.keys(U.prefixes),C=Object.keys(U.separators),P=Object.keys(U.containers),O=P.map(function(e){return U.containers[e].closer}),A="",Object.keys(U.separators).forEach(function(e){U.separators[e].exec===f&&(A=e)}),b="",S="",Object.keys(U.containers).forEach(function(e){U.containers[e].exec===u&&(b=e),U.containers[e].exec===p&&(S=e)}),j="[\\\\"+[t].concat(m).concat(C).concat(P).join("\\").replace("\\"+A,"")+"]",k=new RegExp(j),R="[\\\\\\"+[t].concat(m).concat(C).concat(P).concat(O).join("\\")+"]",q=new RegExp(R,"g"),T=new RegExp("\\"+R.replace(/^\[/,"[^")),D=b||S?new RegExp("\\["+b+S+"]","g"):"",F=new RegExp("\\"+t)},V=function(){U=U||{},U.useCache=!0,U.simple=!1,U.force=!1,U.prefixes={"^":{exec:o},"~":{exec:s},"%":{exec:i},"@":{exec:a}},U.separators={".":{exec:f},",":{exec:c},"<":{exec:l}},U.containers={"[":{closer:"]",exec:f},"'":{closer:"'",exec:u},'"':{closer:'"',exec:p},"(":{closer:")",exec:h},"{":{closer:"}",exec:x}}},Y=function(e){var t=e.replace(D,""),r=t.length;return 2>r?!1:t[0]===t[r-1]&&(t[0]===b||t[0]===S)},z=function(e){return Y(e)?e.slice(1,-1):e},B=function(r){var o="",s=!0,i=[],a=[],x={},y=0,d="",g=!1,v=!1,w="",E=0,m="",C="",P="",O=[],b=0,S=0;if(U.useCache&&N[r]!==e)return N[r];if(o=r.replace(T,"$&".substr(1)),y=o.length,typeof r===n&&!k.test(r))return i=o.split(A),U.useCache&&(N[r]={t:i,simple:s}),{t:i,simple:s};for(E=0;y>E;E++){if(S||"\\"!==o[E]||(S=E+1,E++),o[E]===t&&(g=!0),b>0)if(!S&&o[E]===m&&m!==C.closer&&b++,!S&&o[E]===C.closer&&b--,b>0)w+=o[E];else{if(y>E+1&&U.separators[o[E+1]]&&U.separators[o[E+1]].exec===c){if(w.length&&C.exec===f)a=z(w);else if(C.exec===u||C.exec===p)x.has?(a={w:w,mods:x,doEach:v},x={},s&=!1):(a=w,s&=!0);else{if(a=B(w),a===e)return;a.exec=C.exec,a.doEach=v}O.push(a)}else if(O[0]){if(w.length&&C.exec===f)a=z(w);else if(C.exec===u||C.exec===p)x.has?(a={w:w,mods:x,doEach:v},x={},s&=!1):(a=w,s&=!0);else{if(a=B(w),a===e)return;a.exec=C.exec,a.doEach=v}O.push(a),i.push({tt:O,doEach:v}),O=[],s&=!1}else if(C.exec===f)a={t:[z(w)]},v?(i.push({w:a.t[0],mods:{},doEach:!0}),s&=!1,v=!1):(i.push(a.t[0]),s&=!0);else if(C.exec===u||C.exec===p)x.has?(d={w:w,mods:x,doEach:v},x={},s&=!1):(i.push(w),s&=!0);else{if(a=""===w?{t:[],simple:!0}:B(w),a===e)return;a.exec=C.exec,a.doEach=v,i.push(a),s&=!1}w=""}else if(!S&&o[E]in U.prefixes&&U.prefixes[o[E]].exec)x.has=!0,x[U.prefixes[o[E]].exec]?x[U.prefixes[o[E]].exec]++:x[U.prefixes[o[E]].exec]=1;else if(!S&&U.separators[o[E]]&&U.separators[o[E]].exec){if(P=U.separators[o[E]],!d&&(x.has||g))return;d&&(x.has||g||v)&&(d={w:d,mods:x,doEach:v},x={},s&=!1),P.exec===f||P.exec===l?(O[0]!==e?(d&&O.push(d),i.push({tt:O,doEach:v}),O=[],s&=!1):(d&&i.push(d),s&=!0),v=P.exec===l):P.exec===c&&d&&O.push(d),d="",g=!1}else!S&&U.containers[o[E]]&&U.containers[o[E]].exec?(C=U.containers[o[E]],d&&(x.has||g||v)&&("string"==typeof d?d={w:d,mods:x,doEach:v}:(d.mods=x,d.doEach=v),x={}),O[0]!==e?d&&O.push(d):(d&&i.push(d),s&=!0),m=o[E],d&&U.containers[m].exec!==h&&(v=!1),d="",g=!1,b++):y>E&&(d+=o[E]);y>E&&E===S&&(S=0)}return S||("string"==typeof d&&d&&(x.has||g||v)?(d={w:d,mods:d.mods||x,doEach:v},x={},s&=!1):d&&x.has&&(d.mods=x),O[0]!==e?(d&&O.push(d),i.push({tt:O,doEach:v}),s&=!1):(d&&i.push(d),s&=!0),0!==b)?void 0:(U.useCache&&(N[r]={t:i,simple:s}),console.log("Tokens:",JSON.stringify(i,void 0,2)),{t:i,simple:s})},G=function(t,r,o,s,i){var a,f,c,l=o!==e,u=[],p=0,d=0,g=1,w=0,E=0,m=t,C="",P=0,O=0,A="",b=0,S=t,j=!1,k=0,R="";if(typeof r===n)if(U.useCache&&N[r])u=N[r].t;else{if(u=B(r),u===e)return;u=u.t}else u=r.t?r.t:[r];if(p=u.length,0!==p){for(d=p-1,i?g=i.length:i=[t];m!==e&&p>b;){if(C=u[b],j=l&&b===d,typeof C===n){if(l)if(j){if(S[C]=o,S[C]!==o)return}else U.force&&"undefined"==typeof S[C]&&(S[C]={});f=S[C]}else if(C===e)f=void 0;else if(C.tt)if(f=[],C.doEach){if(!Array.isArray(S))return;for(E=0,O=S.length;O>E;){for(w=0,f.push([]),P=C.tt.length;P>w;){if(C.tt[w].doEach=!1,a=j?G(S[E],C.tt[w],o,s,i):"string"==typeof C.tt[w]?S[E][C.tt[w]]:G(S[E],C.tt[w],void 0,s,i),a===e)return;j?C.tt[w].t&&C.tt[w].exec===x?S[E][a]=o:f[E].push(a):C.tt[w].t&&C.tt[w].exec===x?f[E].push(S[E][a]):f[E].push(a),w++}E++}}else for(w=0,P=C.tt.length;P>w;){if(a=j?G(S,C.tt[w],o,s,i):"string"==typeof C.tt[w]?S[C.tt[w]]:G(S,C.tt[w],void 0,s,i),a===e)return;j?C.tt[w].t&&C.tt[w].exec===x?S[a]=o:f.push(a):C.tt[w].t&&C.tt[w].exec===x?f.push(S[a]):f.push(a),w++}else if(C.w){if(A=C.w,C.mods.has){if(C.mods.parent&&(S=i[g-1-C.mods.parent],S===e))return;if(C.mods.root&&(S=i[0],i=[S],g=1),C.mods.placeholder){if(k=A-1,s[k]===e)return;A=s[k].toString()}}if(C.doEach){if(!Array.isArray(S))return;for(f=[],w=0,O=S.length;O>w;){if(C.mods.context)if(v(A)){if(k=A-1,s[k]===e)return;f.push(s[k])}else f=A;else if(S[w][A]!==e)j&&(S[w][A]=o),f.push(S[w][A]);else if("function"==typeof S[w])f.push(A);else{if(!F.test(A))return;f.push([]);for(R in S[w])y(A,R)&&(j&&(S[w][R]=o),f[w].push(S[w][R]))}w++}}else if(C.mods.context)if(v(A)){if(k=A-1,s[k]===e)return;f=s[k]}else f=A;else if(S[A]!==e)j&&(S[A]=o),f=S[A];else if("function"==typeof S)f=A;else{if(!F.test(A))return;f=[];for(R in S)y(A,R)&&(j&&(S[R]=o),f.push(S[R]))}}else if(C.exec===x)if(C.doEach){if(!Array.isArray(S))return;for(f=[],w=0,O=S.length;O>w;)C.simple?(j&&(S[w][$.get(S[w],{t:C.t,simple:!0})]=o),f.push(S[w][$.get(S[w],{t:C.t,simple:!0})])):(j&&(S[w][G(S[w],C,e,s,i)]=o),f.push(S[w][G(S[w],C,e,s,i)])),w++}else C.simple?(j&&(S[$.get(S,{t:C.t,simple:!0})]=o),f=S[$.get(S,{t:C.t,simple:!0})]):(j&&(S[G(S,C,e,s,i)]=o),f=S[G(S,C,e,s,i)]);else if(C.exec===h)if(C.doEach){if(!Array.isArray(i[g-2]))return;for(f=[],w=0,O=S.length;O>w;)C.t&&C.t.length?(c=G(S,C,e,s,i),c===e?f.push(S[w].apply(i[g-2][w])):Array.isArray(c)?f.push(S[w].apply(i[g-2][w],c)):f.push(S[w].call(i[g-2][w],c))):f.push(S[w].call(i[g-2][w])),w++}else C.t&&C.t.length?(c=C.simple?$.get(S,C):G(S,C,e,s,i),f=c===e?S.apply(i[g-2]):Array.isArray(c)?S.apply(i[g-2],c):S.call(i[g-2],c)):f=S.call(i[g-2]);i[g++]=f,S=f,m=f,b++}return S}},H=function(t,r,n){var o=n!==e,s=[],i=0,a=0;for(s=r.split(A),U.useCache&&(N[r]={t:s,simple:!0}),a=s.length;t!==e&&a>i;){if(""===s[i])return;o&&(i===a-1?t[s[i]]=n:U.force&&"undefined"==typeof t[s[i]]&&(t[s[i]]={})),t=t[s[i++]]}return t},I=function(t,r,n){for(var o=n!==e,s=0,i=r.length;null!=t&&i>s;){if(""===r[s])return;o&&(s===i-1?t[r[s]]=n:U.force&&"undefined"==typeof t[r[s]]&&(t[r[s]]={})),t=t[r[s++]]}return t},K=function(e,t,r,n){var o,s,i,a,f;if(n=n?n:"",e===t)return r(n);if(Array.isArray(e)){for(s=e.length,o=0;s>o;o++)if(i=K(e[o],t,r,n+A+o),!i)return;return!0}if(d(e)){for(a=Object.keys(e),s=a.length,s>1&&(a=a.sort()),o=0;s>o;o++)if(e.hasOwnProperty(a[o])&&(f=a[o],q.test(f)&&(f=E(b,f)),i=K(e[a[o]],t,r,n+A+f),!i))return;return!0}return!0};$.getTokens=function(e){var t=B(e);if(typeof t!==r)return t},$.isValid=function(e){return typeof B(e)!==r},$.escape=function(e){return e.replace(q,"\\$&")},$.get=function(e,t){var r,o=0,s=arguments.length;if(typeof t===n){if(U.useCache&&N[t]&&N[t].simple)return I(e,N[t].t);if(!k.test(t))return H(e,t)}else if(Array.isArray(t.t)&&t.simple)return I(e,t.t);if(r=[],s>2)for(o=2;s>o;o++)r[o-2]=arguments[o];return G(e,t,void 0,r)},$.set=function(t,r,o){var s,i,a=0,f=arguments.length,c=!1;if(typeof r===n?U.useCache&&N[r]&&N[r].simple?(i=I(t,N[r].t,o),c|=!0):k.test(r)||(i=H(t,r,o),c|=!0):Array.isArray(r.t)&&r.simple&&(i=I(t,r.t,o),c|=!0),!c){if(f>3)for(s=[],a=3;f>a;a++)s[a-3]=arguments[a];i=G(t,r,o,s)}return Array.isArray(i)?-1===i.indexOf(void 0):i!==e},$.find=function(e,t,r){var n=[],o=function(e){return n.push(e.substr(1)),r&&"one"!==r?!0:(n=n[0],!1)};return K(e,t,o),n[0]?n:void 0};var L=function(e,t,r,n){var o="";Object.keys(e).forEach(function(r){e[r].exec===t&&(o=r)}),delete e[o],e[r]={exec:t},n&&(e[r].closer=n)},M=function(e){var t={};typeof e===n&&1===e.length||(e="."),t[e]={exec:f},U.prefixes={},U.containers={},U.separators=t};$.setOptions=function(e){if(e.prefixes&&(U.prefixes=e.prefixes,N={}),e.separators&&(U.separators=e.separators,N={}),e.containers&&(U.containers=e.containers,N={}),typeof e.cache!==r&&(U.useCache=!!e.cache),typeof e.simple!==r){var t=U.useCache,n=U.force;U.simple=w(e.simple),U.simple?M():(V(),U.useCache=t,U.force=n),N={}}typeof e.force!==r&&(U.force=w(e.force)),J()},$.setCache=function(e){U.useCache=w(e)},$.setCacheOn=function(){U.useCache=!0},$.setCacheOff=function(){U.useCache=!1},$.setForce=function(e){U.force=w(e)},$.setForceOn=function(){U.force=!0},$.setForceOff=function(){U.force=!1},$.setSimple=function(e,t){var r=U.useCache,n=U.force;U.simple=w(e),U.simple?(M(t),J()):(V(),J(),U.useCache=r,U.force=n),N={}},$.setSimpleOn=function(e){U.simple=!0,M(e),J(),N={}},$.setSimpleOff=function(){var e=U.useCache,t=U.force;U.simple=!1,V(),J(),U.useCache=e,U.force=t,N={}},$.setSeparatorProperty=function(e){if(typeof e!==n||1!==e.length)throw new Error("setSeparatorProperty - invalid value");if(e===t||U.separators[e]&&U.separators[e].exec!==f||U.prefixes[e]||U.containers[e])throw new Error("setSeparatorProperty - value already in use");L(U.separators,f,e),J(),N={}},$.setSeparatorCollection=function(e){if(typeof e!==n||1!==e.length)throw new Error("setSeparatorCollection - invalid value");if(e===t||U.separators[e]&&U.separators[e].exec!==c||U.prefixes[e]||U.containers[e])throw new Error("setSeparatorCollection - value already in use");L(U.separators,c,e),J(),N={}},$.setPrefixParent=function(e){if(typeof e!==n||1!==e.length)throw new Error("setPrefixParent - invalid value");if(e===t||U.prefixes[e]&&U.prefixes[e].exec!==o||U.separators[e]||U.containers[e])throw new Error("setPrefixParent - value already in use");L(U.prefixes,o,e),J(),N={}},$.setPrefixRoot=function(e){if(typeof e!==n||1!==e.length)throw new Error("setPrefixRoot - invalid value");if(e===t||U.prefixes[e]&&U.prefixes[e].exec!==s||U.separators[e]||U.containers[e])throw new Error("setPrefixRoot - value already in use");L(U.prefixes,s,e),J(),N={}},$.setPrefixPlaceholder=function(e){if(typeof e!==n||1!==e.length)throw new Error("setPrefixPlaceholder - invalid value");if(e===t||U.prefixes[e]&&U.prefixes[e].exec!==i||U.separators[e]||U.containers[e])throw new Error("setPrefixPlaceholder - value already in use");L(U.prefixes,i,e),J(),N={}},$.setPrefixContext=function(e){if(typeof e!==n||1!==e.length)throw new Error("setPrefixContext - invalid value");if(e===t||U.prefixes[e]&&U.prefixes[e].exec!==a||U.separators[e]||U.containers[e])throw new Error("setPrefixContext - value already in use");L(U.prefixes,a,e),J(),N={}},$.setContainerProperty=function(e,r){if(typeof e!==n||1!==e.length||typeof r!==n||1!==r.length)throw new Error("setContainerProperty - invalid value");if(e===t||U.containers[e]&&U.containers[e].exec!==f||U.separators[e]||U.prefixes[e])throw new Error("setContainerProperty - value already in use");L(U.containers,f,e,r),J(),N={}},$.setContainerSinglequote=function(e,r){if(typeof e!==n||1!==e.length||typeof r!==n||1!==r.length)throw new Error("setContainerSinglequote - invalid value");if(e===t||U.containers[e]&&U.containers[e].exec!==u||U.separators[e]||U.prefixes[e])throw new Error("setContainerSinglequote - value already in use");L(U.containers,u,e,r),J(),N={}},$.setContainerDoublequote=function(e,r){if(typeof e!==n||1!==e.length||typeof r!==n||1!==r.length)throw new Error("setContainerDoublequote - invalid value");if(e===t||U.containers[e]&&U.containers[e].exec!==p||U.separators[e]||U.prefixes[e])throw new Error("setContainerDoublequote - value already in use");L(U.containers,p,e,r),J(),N={}},$.setContainerCall=function(e,r){if(typeof e!==n||1!==e.length||typeof r!==n||1!==r.length)throw new Error("setContainerCall - invalid value");if(e===t||U.containers[e]&&U.containers[e].exec!==h||U.separators[e]||U.prefixes[e])throw new Error("setContainerCall - value already in use");L(U.containers,h,e,r),J(),N={}},$.setContainerEvalProperty=function(e,r){if(typeof e!==n||1!==e.length||typeof r!==n||1!==r.length)throw new Error("setContainerProperty - invalid value");if(e===t||U.containers[e]&&U.containers[e].exec!==x||U.separators[e]||U.prefixes[e])throw new Error("setContainerEvalProperty - value already in use");L(U.containers,x,e,r),J(),N={}},$.resetOptions=function(){V(),J(),N={}},V(),J(),g&&$.setOptions(g)};return m});
//# sourceMappingURL=index.js.map